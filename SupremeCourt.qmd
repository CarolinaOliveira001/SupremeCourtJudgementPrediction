---
title: "SupremeCourt"
format: html
editor: source
---

```{r, echo=FALSE}
library(dplyr)
library(data.table)
library(rvest)
library(rjson)
```

```{r}
justice <- fread("justice.csv")
justice$V1 <- data.frame(Index=justice$V1)
```

```{r}
detailedJustice <- data.frame(id = c(),
                   docket_number = c(),
                   question = c(),
                   conclusion = c(),
                   advocate_name = c(),
                   judges = c(),
                   city = c(),
                   province_name = c())
```

```{r}
isNullHelpFunction <- function(x){
  if(is.null(x)){
    "NA"} 
  else {
    x}
}
```

```{r}
hrefVector <- justice$href
for (x in 1:length(hrefVector)) {
  dataJson <- jsonlite::fromJSON(txt = hrefVector[x])

  helpfulDF <- c(isNullHelpFunction(dataJson$ID),
                 trimws(isNullHelpFunction(dataJson$docket_number), which = "r"),
                 isNullHelpFunction(dataJson$question), 
                 isNullHelpFunction(dataJson$conclusion), 
                 paste(as.character(dataJson$advocates$advocate$name), collapse=", "), 
                 paste(as.character(dataJson$decided_by$members$name), collapse=", "),
                 isNullHelpFunction(dataJson$location$city), 
                 isNullHelpFunction(dataJson$location$province_name))
  
  detailedJustice <- rbind(detailedJustice, helpfulDF)
  
  remove(helpfulDF)
  remove(dataJson)
}
```

```{r}
colnames(detailedJustice) <- c("ID", "docket", "question", "conclusion", 
                               "advocate_name", "judges", "city", "province_name")
```

```{r}
allJustice <- merge(x = justice, y = detailedJustice, by = c("ID", "docket"))
```

```{r}
write.csv(allJustice,"allJustice.csv", row.names = TRUE)
```






